<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>springbootæ•´åˆå¤šæ•°æ®æº | è·³è·³çŒª</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="icon" href="/logo.jpg">
    <meta name="description" content="åƒå¾—å¥½ï¼Œç¡å¾—å¥½">
    
    <link rel="preload" href="/assets/css/0.styles.542f065b.css" as="style"><link rel="preload" href="/assets/js/app.9ac200f5.js" as="script"><link rel="preload" href="/assets/js/2.f08c2e94.js" as="script"><link rel="preload" href="/assets/js/41.0955ce39.js" as="script"><link rel="prefetch" href="/assets/js/10.104e03e5.js"><link rel="prefetch" href="/assets/js/11.18d17b89.js"><link rel="prefetch" href="/assets/js/12.31c398a8.js"><link rel="prefetch" href="/assets/js/13.b5ee2d7d.js"><link rel="prefetch" href="/assets/js/14.a60f524e.js"><link rel="prefetch" href="/assets/js/15.55fd61b8.js"><link rel="prefetch" href="/assets/js/16.7aa17999.js"><link rel="prefetch" href="/assets/js/17.24758699.js"><link rel="prefetch" href="/assets/js/18.0b71a4f7.js"><link rel="prefetch" href="/assets/js/19.4770b075.js"><link rel="prefetch" href="/assets/js/20.fe4d448c.js"><link rel="prefetch" href="/assets/js/21.6ef119a3.js"><link rel="prefetch" href="/assets/js/22.68798857.js"><link rel="prefetch" href="/assets/js/23.a8a337ba.js"><link rel="prefetch" href="/assets/js/24.c156d0fe.js"><link rel="prefetch" href="/assets/js/25.b840f4b8.js"><link rel="prefetch" href="/assets/js/26.37c5f756.js"><link rel="prefetch" href="/assets/js/27.5b776d07.js"><link rel="prefetch" href="/assets/js/28.4d89a988.js"><link rel="prefetch" href="/assets/js/29.d8405b8b.js"><link rel="prefetch" href="/assets/js/3.98efb80c.js"><link rel="prefetch" href="/assets/js/30.67c25a87.js"><link rel="prefetch" href="/assets/js/31.cd45304b.js"><link rel="prefetch" href="/assets/js/32.b0bff8a4.js"><link rel="prefetch" href="/assets/js/33.b8e0beb7.js"><link rel="prefetch" href="/assets/js/34.eedead55.js"><link rel="prefetch" href="/assets/js/35.44fef23e.js"><link rel="prefetch" href="/assets/js/36.3e7830e5.js"><link rel="prefetch" href="/assets/js/37.8f711bb3.js"><link rel="prefetch" href="/assets/js/38.3b7df8b6.js"><link rel="prefetch" href="/assets/js/39.a7dfb50c.js"><link rel="prefetch" href="/assets/js/4.2e894fd2.js"><link rel="prefetch" href="/assets/js/40.ba597a3a.js"><link rel="prefetch" href="/assets/js/42.b1629e72.js"><link rel="prefetch" href="/assets/js/43.606f57ec.js"><link rel="prefetch" href="/assets/js/44.5e8f4801.js"><link rel="prefetch" href="/assets/js/45.fc255c2f.js"><link rel="prefetch" href="/assets/js/46.9222248d.js"><link rel="prefetch" href="/assets/js/47.d6bf833e.js"><link rel="prefetch" href="/assets/js/48.40e23b48.js"><link rel="prefetch" href="/assets/js/49.ba7c2b8d.js"><link rel="prefetch" href="/assets/js/5.d2ef2a1a.js"><link rel="prefetch" href="/assets/js/50.487406c6.js"><link rel="prefetch" href="/assets/js/51.3f8ea397.js"><link rel="prefetch" href="/assets/js/52.acd66974.js"><link rel="prefetch" href="/assets/js/53.58c7fc05.js"><link rel="prefetch" href="/assets/js/54.0f8282f4.js"><link rel="prefetch" href="/assets/js/55.ad7bb205.js"><link rel="prefetch" href="/assets/js/56.590655d9.js"><link rel="prefetch" href="/assets/js/57.9a85aa7a.js"><link rel="prefetch" href="/assets/js/58.1b4ef9fd.js"><link rel="prefetch" href="/assets/js/59.9420c0ba.js"><link rel="prefetch" href="/assets/js/6.65a955fd.js"><link rel="prefetch" href="/assets/js/60.30009201.js"><link rel="prefetch" href="/assets/js/61.0047220f.js"><link rel="prefetch" href="/assets/js/62.a368a893.js"><link rel="prefetch" href="/assets/js/63.3315d70a.js"><link rel="prefetch" href="/assets/js/64.3e3c478f.js"><link rel="prefetch" href="/assets/js/65.80a47305.js"><link rel="prefetch" href="/assets/js/66.ae967862.js"><link rel="prefetch" href="/assets/js/67.606a99c5.js"><link rel="prefetch" href="/assets/js/68.46eb6539.js"><link rel="prefetch" href="/assets/js/69.c6067a0e.js"><link rel="prefetch" href="/assets/js/7.ed4f4e88.js"><link rel="prefetch" href="/assets/js/8.517c5e6e.js"><link rel="prefetch" href="/assets/js/9.bef30b40.js">
    <link rel="stylesheet" href="/assets/css/0.styles.542f065b.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu have-body-img"><header class="navbar blur"><div title="ç›®å½•" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="https://excalidraw.com/apple-touch-icon.png" alt="è·³è·³çŒª" class="logo"> <span class="site-name can-hide">è·³è·³çŒª</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/md/java/JAVAåŸºç¡€.html" class="nav-link">JAVA</a></div><div class="nav-item"><a href="/md/database/mysql/MySqlæ“ä½œ.html" class="nav-link">æ•°æ®åº“</a></div><div class="nav-item"><a href="/md/opSystem/linux/linuxæ“ä½œç¬”è®°.html" class="nav-link">æ“ä½œç³»ç»Ÿ</a></div><div class="nav-item"><a href="/md/middleware/mq/æ¶ˆæ¯é˜Ÿåˆ—.html" class="nav-link">ä¸­é—´ä»¶</a></div><div class="nav-item"><a href="/md/tool/docker/docker.html" class="nav-link">å¼€å‘å·¥å…·</a></div><div class="nav-item"><a href="/md/designPattern/" class="nav-link">è®¾è®¡æ¨¡å¼</a></div><div class="nav-item"><a href="/md/netty/BIOã€NIOã€AIO.html" class="nav-link">netty</a></div><div class="nav-item"><a href="/md/DDD/å°å‚…å“¥æ¡ˆä¾‹å­¦ä¹ æ‰“å¡/DDDæŠ½å¥–ç³»ç»Ÿå­¦ä¹ æ‰“å¡ğŸš€ day 1.html" class="nav-link">DDD</a></div><div class="nav-item"><a href="/md/other/é¢è¯•é¢˜.html" class="nav-link">other</a></div><div class="nav-item"><a href="/md/notes/" class="nav-link">æµ‹è¯•</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="æç¤ºè¯­" class="dropdown-title"><!----> <span class="title" style="display:;">æµ‹è¯•ä¸‹æ‹‰èœå•</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/md/notes/" class="nav-link">èœå•1</a></li><li class="dropdown-item"><!----> <a href="/md/notes/" class="nav-link">èœå•2</a></li><li class="dropdown-item"><h4>å¤šæ¬¡èœå•</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/md/notes/" class="nav-link">å¤šçº§èœå•1</a></li></ul></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar-hover-trigger"></div> <aside class="sidebar" style="display:none;"><!----> <nav class="nav-links"><div class="nav-item"><a href="/md/java/JAVAåŸºç¡€.html" class="nav-link">JAVA</a></div><div class="nav-item"><a href="/md/database/mysql/MySqlæ“ä½œ.html" class="nav-link">æ•°æ®åº“</a></div><div class="nav-item"><a href="/md/opSystem/linux/linuxæ“ä½œç¬”è®°.html" class="nav-link">æ“ä½œç³»ç»Ÿ</a></div><div class="nav-item"><a href="/md/middleware/mq/æ¶ˆæ¯é˜Ÿåˆ—.html" class="nav-link">ä¸­é—´ä»¶</a></div><div class="nav-item"><a href="/md/tool/docker/docker.html" class="nav-link">å¼€å‘å·¥å…·</a></div><div class="nav-item"><a href="/md/designPattern/" class="nav-link">è®¾è®¡æ¨¡å¼</a></div><div class="nav-item"><a href="/md/netty/BIOã€NIOã€AIO.html" class="nav-link">netty</a></div><div class="nav-item"><a href="/md/DDD/å°å‚…å“¥æ¡ˆä¾‹å­¦ä¹ æ‰“å¡/DDDæŠ½å¥–ç³»ç»Ÿå­¦ä¹ æ‰“å¡ğŸš€ day 1.html" class="nav-link">DDD</a></div><div class="nav-item"><a href="/md/other/é¢è¯•é¢˜.html" class="nav-link">other</a></div><div class="nav-item"><a href="/md/notes/" class="nav-link">æµ‹è¯•</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="æç¤ºè¯­" class="dropdown-title"><!----> <span class="title" style="display:;">æµ‹è¯•ä¸‹æ‹‰èœå•</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/md/notes/" class="nav-link">èœå•1</a></li><li class="dropdown-item"><!----> <a href="/md/notes/" class="nav-link">èœå•2</a></li><li class="dropdown-item"><h4>å¤šæ¬¡èœå•</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/md/notes/" class="nav-link">å¤šçº§èœå•1</a></li></ul></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>JAVA</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/dc132d/" class="sidebar-link">JAVAåŸºç¡€</a></li><li><a href="/pages/d9f5d1/" class="sidebar-link">java8æ–°ç‰¹æ€§</a></li><li><a href="/pages/b4de67/" class="sidebar-link">JVM</a></li><li><a href="/pages/4ef7a0/" class="sidebar-link">Spring</a></li><li><a href="/pages/4bcf6f/" class="sidebar-link">SpringBoot</a></li><li><a href="/pages/bf25fe/" class="sidebar-link">Gatewayç½‘å…³</a></li><li><a href="/pages/7a7d4b/" class="sidebar-link">å¹¶å‘å¸¸è§</a></li><li><a href="/pages/fd10b9/" class="sidebar-link">åˆ†å¸ƒå¼äº‹åŠ¡</a></li><li><a href="/pages/74109b/" aria-current="page" class="active sidebar-link">springbootæ•´åˆå¤šæ•°æ®æº</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level2"><a href="/pages/74109b/#ç®€ä»‹" class="sidebar-link">ç®€ä»‹ï¼š</a></li><li class="sidebar-sub-header level2"><a href="/pages/74109b/#ç‰ˆæœ¬" class="sidebar-link">ç‰ˆæœ¬ï¼š</a></li><li class="sidebar-sub-header level2"><a href="/pages/74109b/#ä¸€ã€åˆ†åŒ…æ–¹å¼å®ç°" class="sidebar-link">ä¸€ã€åˆ†åŒ…æ–¹å¼å®ç°ï¼š</a></li><li class="sidebar-sub-header level2"><a href="/pages/74109b/#äºŒã€aopå®ç°" class="sidebar-link">äºŒã€AOPå®ç°ï¼š</a></li><li class="sidebar-sub-header level2"><a href="/pages/74109b/#ä¸‰ã€ä½¿ç”¨æ³¨è§£æ•´åˆ" class="sidebar-link">ä¸‰ã€ä½¿ç”¨æ³¨è§£æ•´åˆ</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/74109b/#ä¸»è¦ä¾èµ–" class="sidebar-link">ä¸»è¦ä¾èµ–</a></li><li class="sidebar-sub-header level3"><a href="/pages/74109b/#application-yml-é…ç½®æ–‡ä»¶" class="sidebar-link">application.yml é…ç½®æ–‡ä»¶</a></li><li class="sidebar-sub-header level3"><a href="/pages/74109b/#ç»™ä½¿ç”¨éé»˜è®¤æ•°æ®æºæ·»åŠ æ³¨è§£-ds" class="sidebar-link">ç»™ä½¿ç”¨éé»˜è®¤æ•°æ®æºæ·»åŠ æ³¨è§£@DS</a></li></ul></li></ul></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>æ•°æ®ç»“æ„å’Œç®—æ³•</span> <span class="arrow right"></span></p> <!----></section></li></ul></section></li></ul> </aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-06225672><div class="articleInfo" data-v-06225672><ul class="breadcrumbs" data-v-06225672><li data-v-06225672><a href="/" title="é¦–é¡µ" class="iconfont icon-home router-link-active" data-v-06225672></a></li> <li data-v-06225672><span data-v-06225672>md</span></li><li data-v-06225672><span data-v-06225672>java</span></li></ul> <div class="info" data-v-06225672><!----> <div title="åˆ›å»ºæ—¶é—´" class="date iconfont icon-riqi" data-v-06225672><a href="javascript:;" data-v-06225672>2022-10-27</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-title">ç›®å½•</div> <div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABGpJREFUSA3tVVtoXFUU3fvOI53UlmCaKIFmwEhsE7QK0ipFEdHEKpXaZGrp15SINsXUWvBDpBgQRKi0+KKoFeJHfZA+ED9KKoIU2gYD9UejTW4rVIzm0VSTziPzuNu1z507dibTTjL4U/DAzLn3nL3X2o91ziX6f9wMFdh6Jvbm9nNSV0msViVO6tN1Rm7NMu2OpeJ9lWBUTDxrJbYTS0hInuwciu9eLHlFxCLCZEk3MegsJmZ5K/JD6t7FkFdEvGUo1g7qJoG3MHImqRIn8/nzY1K9UPKKiJmtnUqHVE3Gbuay6vJE/N2FEmuxFjW2nUuE0yQXRRxLiTUAzs36zhZvOXJPdX850EVnnLZkB8prodQoM5JGj7Xk2mvC7JB8tG04Ef5PiXtG0UtxupRQSfTnBoCy554x18yJHI6I+G5Eru4LHmPJZEQsrvPUbMiA8G/WgMK7w7I+ez7++o2ANfbrjvaOl1tFMs+htG3IrZH9/hDX1Pr8Tc0UvH8tcX29KzAgIGcEkINyW5BF9x891hw6VYqgJHEk0huccS7vh3C6gTiODL+26huuBtbct8eZnqLML8PkxGYpuPZBqtqwkSjgc4mB5gbgig5i+y0UDK35LMxXisn9xQtK+nd26gTIHsHe/oblK/b29fUmN/8Y+9jAQrnBp56m1LcDlDp9irKTExSKduXJVWSqdBMA08pEJnEIOB3FPPMybu/oeV8zFeYN3xx576Q6RH+VmplE4ncQV5v+5rzSoyOU7PuEAg8g803PwBJ0CExno/jcMbN8tONYeOmHiuUNryvm3fRUy4tMPVLdAGkUhNWuggGrJcXPv+ouCjz0MKUHz1J2/E8IC9nqTabcxgaBYM0hPhD5Y65FsbxRQKxCQrDjDctW7PUM3HuZunFyifSAqEfuzCp48Il24luWUWZoyJCaPR82jE0+kFA643wRFVni4RYSq3ohJO2pZ7B5dO4xkDWbEpossJPLSrPjYID8rS2UHTlvyNxqIGsg674XJJ7vnh5L7PNwC4hh2sjCI96mzszOTpxLF0T7l88Yz7lAuK6OnL8gXLOnTvpzSb22YG8W7us3jSebFHeeqnXRG1vt+MoUM84LQIBmMsCTAcOauTh0T0l0neQK7m2bLMt2mGxU3HYssS0J2cdv5wljlPsrIuZLAG/2DOZIXgCYT8uMGZN+e2kSirfxZOPCsC0f24nTZzspnVn9VePS1Z5vubmAGGXG8ZFno9Hel0yfA5ZPhF7Dh972BQJ2qCpgH67lmWtBYbvk6sz02wjky2vXyz0XErP/kFB619js1BtwfOV4OPRqOQBjy3Qbk18vigUPPSD5ceHnwck7W9bhAqZdd7SuG7w4/P2F/GaJh8c7e9qgow+Q7cGBo+98WsLkuktFqiZabtXuQTu/Y5ETbR0v7tNSFnvrmu6pjdoan2KjMu8q/Hmj1EfCO2ZGfEIbIXKUlw8qaX9/b2oeSJmFksSeT/Fn0V3nSypChh4Gjh74ybO9aeZ/AN2dwciu2/MhAAAAAElFTkSuQmCC">springbootæ•´åˆå¤šæ•°æ®æº<!----></h1> <!----> <div class="theme-vdoing-content content__default"><h1 id="springbootæ•´åˆå¤šæ•°æ®æº"><a href="#springbootæ•´åˆå¤šæ•°æ®æº" class="header-anchor">#</a> springbootæ•´åˆå¤šæ•°æ®æº</h1> <h1 id="springbootæ•´åˆå¤šæ•°æ®æº-2"><a href="#springbootæ•´åˆå¤šæ•°æ®æº-2" class="header-anchor">#</a> springbootæ•´åˆå¤šæ•°æ®æº</h1> <p>å‚è€ƒé“¾æ¥: https://www.cnblogs.com/aizen-sousuke/p/11756279.html å‚è€ƒé“¾æ¥: https://blog.csdn.net/tuesdayma/article/details/81081666</p> <h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="header-anchor">#</a> ç®€ä»‹ï¼š</h2> <p>éšç€å¹¶å‘é‡çš„ä¸æ–­å¢åŠ ï¼Œæ˜¾ç„¶å•ä¸ªæ•°æ®åº“å·²ç»æ‰¿å—ä¸äº†é«˜å¹¶å‘å¸¦æ¥çš„å‹åŠ›ã€‚ä¸€ä¸ªé¡¹ç›®ä½¿ç”¨å¤šä¸ªæ•°æ®åº“ï¼ˆæ— è®ºæ˜¯ä¸»ä»å¤åˆ¶- - è¯»å†™åˆ†ç¦»è¿˜æ˜¯åˆ†å¸ƒå¼æ•°æ®åº“ç»“æ„ï¼‰çš„é‡è¦æ€§å˜å¾—è¶Šæ¥è¶Šæ˜æ˜¾ã€‚ä¼ ç»Ÿé¡¹ç›®ä¸­ï¼ˆä¸ªäººå¯¹ä¼ ç»Ÿé¡¹ç›®çš„ç†è§£å°±æ˜¯æ‰€æœ‰çš„ä¸šåŠ¡æ¨¡å—éƒ½åœ¨ä¸€ä¸ªtomcatä¸­å®Œæˆï¼Œå¤šä¸ªç›¸åŒçš„tomcaté›†ç¾¤ä¹Ÿå¯è®¤ä¸ºæ˜¯ä¼ ç»Ÿé¡¹ç›®ï¼‰æ•´åˆå¤šæ•°æ®æºæœ‰ä¸¤ç§æ–¹æ³•ï¼šåˆ†åŒ…å’ŒAOPã€‚</p> <h2 id="ç‰ˆæœ¬"><a href="#ç‰ˆæœ¬" class="header-anchor">#</a> ç‰ˆæœ¬ï¼š</h2> <p>springbootï¼š1.5.9.RELEASE mariadbï¼š5.7</p> <h2 id="ä¸€ã€åˆ†åŒ…æ–¹å¼å®ç°"><a href="#ä¸€ã€åˆ†åŒ…æ–¹å¼å®ç°" class="header-anchor">#</a> ä¸€ã€åˆ†åŒ…æ–¹å¼å®ç°ï¼š</h2> <p>springboot+mybatis</p> <p><strong>1ã€åœ¨application.propertiesä¸­é…ç½®ä¸¤ä¸ªæ•°æ®åº“ï¼š</strong></p> <div class="language- extra-class"><pre class="language-text"><code>## test1 databasespring.datasource.test1.url=jdbc:mysql://localhost:3307/multipledatasource1?useUnicode=true&amp;characterEncoding=UTF-8&amp;serverTimezone=UTC&amp;useSSL=falsespring.datasource.test1.username=rootspring.datasource.test1.password=rootspring.datasource.test1.driver-class-name=com.mysql.cj.jdbc.Driver## test2 databasespring.datasource.test2.url=jdbc:mysql://localhost:3307/multipledatasource2?useUnicode=true&amp;characterEncoding=UTF-8&amp;serverTimezone=UTC&amp;useSSL=falsespring.datasource.test2.username=rootspring.datasource.test2.password=rootspring.datasource.test2.driver-class-name=com.mysql.cj.jdbc.Driver12345678910
</code></pre></div><p><strong>2ã€å»ºç«‹è¿ä¸ªæ•°æ®æºçš„é…ç½®æ–‡ä»¶ï¼š</strong></p> <p>springboootä¸­çš„å‚æ•°å¯ä»¥å‚è€ƒä¸Šä¸€ç¯‡åšå®¢ï¼ˆä¸å®šæœŸæ›´æ–°ä¸­ï¼‰ï¼šhttps://blog.csdn.net/tuesdayma/article/details/81029539</p> <p>ç¬¬ä¸€ä¸ªé…ç½®æ–‡ä»¶ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>//è¡¨ç¤ºè¿™ä¸ªç±»ä¸ºä¸€ä¸ªé…ç½®ç±»@Configuration// é…ç½®mybatisçš„æ¥å£ç±»æ”¾çš„åœ°æ–¹@MapperScan(basePackages = &quot;com.mzd.multipledatasources.mapper.test01&quot;, sqlSessionFactoryRef = &quot;test1SqlSessionFactory&quot;)public class DataSourceConfig1 {    // å°†è¿™ä¸ªå¯¹è±¡æ”¾å…¥Springå®¹å™¨ä¸­    @Bean(name = &quot;test1DataSource&quot;)    // è¡¨ç¤ºè¿™ä¸ªæ•°æ®æºæ˜¯é»˜è®¤æ•°æ®æº    @Primary    // è¯»å–application.propertiesä¸­çš„é…ç½®å‚æ•°æ˜ å°„æˆä¸ºä¸€ä¸ªå¯¹è±¡    // prefixè¡¨ç¤ºå‚æ•°çš„å‰ç¼€    @ConfigurationProperties(prefix = &quot;spring.datasource.test1&quot;)    public DataSource getDateSource1() {        return DataSourceBuilder.create().build();    }    @Bean(name = &quot;test1SqlSessionFactory&quot;)    // è¡¨ç¤ºè¿™ä¸ªæ•°æ®æºæ˜¯é»˜è®¤æ•°æ®æº    @Primary    // @Qualifierè¡¨ç¤ºæŸ¥æ‰¾Springå®¹å™¨ä¸­åå­—ä¸ºtest1DataSourceçš„å¯¹è±¡    public SqlSessionFactory test1SqlSessionFactory(@Qualifier(&quot;test1DataSource&quot;) DataSource datasource)            throws Exception {        SqlSessionFactoryBean bean = new SqlSessionFactoryBean();        bean.setDataSource(datasource);        bean.setMapperLocations(                // è®¾ç½®mybatisçš„xmlæ‰€åœ¨ä½ç½®                new PathMatchingResourcePatternResolver().getResources(&quot;classpath*:mapping/test01/*.xml&quot;));        return bean.getObject();    }    @Bean(&quot;test1SqlSessionTemplate&quot;)    // è¡¨ç¤ºè¿™ä¸ªæ•°æ®æºæ˜¯é»˜è®¤æ•°æ®æº    @Primary    public SqlSessionTemplate test1sqlsessiontemplate(            @Qualifier(&quot;test1SqlSessionFactory&quot;) SqlSessionFactory sessionfactory) {        return new SqlSessionTemplate(sessionfactory);    }}123456789101112131415161718192021222324252627282930313233343536
</code></pre></div><p>ç¬¬äºŒä¸ªé…ç½®æ–‡ä»¶ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>@Configuration@MapperScan(basePackages = &quot;com.mzd.multipledatasources.mapper.test02&quot;, sqlSessionFactoryRef = &quot;test2SqlSessionFactory&quot;)public class DataSourceConfig2 {    @Bean(name = &quot;test2DataSource&quot;)    @ConfigurationProperties(prefix = &quot;spring.datasource.test2&quot;)    public DataSource getDateSource2() {        return DataSourceBuilder.create().build();    }    @Bean(name = &quot;test2SqlSessionFactory&quot;)    public SqlSessionFactory test2SqlSessionFactory(@Qualifier(&quot;test2DataSource&quot;) DataSource datasource)            throws Exception {        SqlSessionFactoryBean bean = new SqlSessionFactoryBean();        bean.setDataSource(datasource);        bean.setMapperLocations(                new PathMatchingResourcePatternResolver().getResources(&quot;classpath*:mapping/test02/*.xml&quot;));        return bean.getObject();    }    @Bean(&quot;test2SqlSessionTemplate&quot;)    public SqlSessionTemplate test2sqlsessiontemplate(            @Qualifier(&quot;test2SqlSessionFactory&quot;) SqlSessionFactory sessionfactory) {        return new SqlSessionTemplate(sessionfactory);    }}123456789101112131415161718192021222324
</code></pre></div><p>æ³¨æ„ï¼š</p> <p>1ã€@Primaryè¿™ä¸ªæ³¨è§£å¿…é¡»è¦åŠ ï¼Œå› ä¸ºä¸åŠ çš„è¯springå°†åˆ†ä¸æ¸…æ¥šé‚£ä¸ªä¸ºä¸»æ•°æ®æºï¼ˆé»˜è®¤æ•°æ®æºï¼‰</p> <p>2ã€mapperçš„æ¥å£ã€xmlå½¢å¼ä»¥åŠdaoå±‚éƒ½éœ€è¦ä¸¤ä¸ªåˆ†å¼€ï¼Œç›®å½•å¦‚å›¾ï¼š</p> <p><a href="https://img-blog.csdn.net/20180717154735494?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3R1ZXNkYXltYQ==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" target="_blank" rel="noopener noreferrer">https://img-blog.csdn.net/20180717154735494?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3R1ZXNkYXltYQ==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>3ã€bean.setMapperLocations(new PathMatchingResourcePatternResolver().getResources(â€œXXXXâ€));mapperçš„xmlå½¢å¼æ–‡ä»¶ä½ç½®å¿…é¡»è¦é…ç½®ï¼Œä¸ç„¶å°†æŠ¥é”™ï¼šno statement ï¼ˆè¿™ç§é”™è¯¯ä¹Ÿå¯èƒ½æ˜¯mapperçš„xmlä¸­ï¼Œnamespaceä¸é¡¹ç›®çš„è·¯å¾„ä¸ä¸€è‡´å¯¼è‡´çš„ï¼Œå…·ä½“çœ‹æƒ…å†µå§ï¼Œæ³¨æ„ä¸€ä¸‹å°±è¡Œï¼Œé—®é¢˜ä¸å¤§çš„ï¼‰</p> <p>4ã€åœ¨serviceå±‚ä¸­æ ¹æ®ä¸åŒçš„ä¸šåŠ¡æ³¨å…¥ä¸åŒçš„daoå±‚ã€‚</p> <p>5ã€å¦‚æœæ˜¯ä¸»ä»å¤åˆ¶- -è¯»å†™åˆ†ç¦»ï¼šæ¯”å¦‚test01ä¸­è´Ÿè´£å¢åˆ æ”¹ï¼Œtest02ä¸­è´Ÿè´£æŸ¥è¯¢ã€‚ä½†æ˜¯éœ€è¦æ³¨æ„çš„æ˜¯è´Ÿè´£å¢åˆ æ”¹çš„æ•°æ®åº“å¿…é¡»æ˜¯ä¸»åº“ï¼ˆmasterï¼‰</p> <p>6ã€å¦‚æœæ˜¯åˆ†å¸ƒå¼ç»“æ„çš„è¯ï¼Œä¸åŒæ¨¡å—æ“ä½œå„è‡ªçš„æ•°æ®åº“å°±å¥½ï¼Œtest01åŒ…ä¸‹å…¨æ˜¯test01ä¸šåŠ¡ï¼Œtest02å…¨æ˜¯test02ä¸šåŠ¡ï¼Œä½†æ˜¯å¦‚æœtest01ä¸­æºæ‚ç€test02çš„ç¼–è¾‘æ“ä½œï¼Œè¿™æ—¶å€™å°†ä¼šäº§ç”Ÿäº‹åŠ¡é—®é¢˜ï¼šå³test01ä¸­çš„äº‹åŠ¡æ˜¯æ²¡æ³•æ§åˆ¶test02çš„äº‹åŠ¡çš„ï¼Œè¿™ä¸ªé—®é¢˜åœ¨ä¹‹åçš„åšå®¢ä¸­ä¼šè§£å†³ã€‚</p> <h2 id="äºŒã€aopå®ç°"><a href="#äºŒã€aopå®ç°" class="header-anchor">#</a> äºŒã€AOPå®ç°ï¼š</h2> <p><strong>ç®€ä»‹ï¼š</strong> ç”¨è¿™ç§æ–¹å¼å®ç°å¤šæ•°æ®æºçš„å‰æå¿…é¡»è¦æ¸…æ¥šä¸¤ä¸ªçŸ¥è¯†ç‚¹ï¼šAOPåŸç†å’ŒAbstractRoutingDataSourceæŠ½è±¡ç±»ã€‚</p> <p>**1ã€AOPï¼š**è¿™ä¸ªä¸œè¥¿ã€‚ã€‚ã€‚ä¸åˆ‡å½“çš„è¯´å°±æ˜¯ç›¸å½“äºæ‹¦æˆªå™¨ï¼Œåªè¦æ»¡è¶³è¦æ±‚çš„éƒ½ä¼šè¢«æ‹¦æˆªè¿‡æ¥ï¼Œç„¶åè¿›è¡Œä¸€äº›åˆ—çš„æ“ä½œã€‚å…·ä½“éœ€è¦è‡ªå·±å»ä½“ä¼šã€‚ã€‚ã€‚</p> <p>**2ã€AbstractRoutingDataSourceï¼š**è¿™ä¸ªç±»æ˜¯å®ç°å¤šæ•°æ®æºçš„å…³é”®ï¼Œä»–çš„ä½œç”¨å°±æ˜¯åŠ¨æ€åˆ‡æ¢æ•°æ®æºï¼Œå®è´¨ï¼šæœ‰å¤šå°‘ä¸ªæ•°æ®æºå°±å­˜å¤šå°‘ä¸ªæ•°æ®æºåœ¨targetDataSourcesï¼ˆæ˜¯AbstractRoutingDataSourceçš„ä¸€ä¸ªmapç±»å‹çš„å±æ€§ï¼Œå…¶ä¸­valueä¸ºæ¯ä¸ªæ•°æ®æºï¼Œkeyè¡¨ç¤ºæ¯ä¸ªæ•°æ®æºçš„åå­—ï¼‰è¿™ä¸ªå±æ€§ä¸­ï¼Œç„¶åæ ¹æ®determineCurrentLookupKeyï¼ˆï¼‰è¿™ä¸ªæ–¹æ³•è·å–å½“å‰æ•°æ®æºåœ¨mapä¸­çš„keyå€¼ï¼Œç„¶ådetermineTargetDataSourceï¼ˆï¼‰æ–¹æ³•ä¸­åŠ¨æ€è·å–å½“å‰æ•°æ®æºï¼Œå¦‚æœå½“å‰æ•°æ®æºä¸å­˜å¹¶ä¸”é»˜è®¤æ•°æ®æºä¹Ÿä¸å­˜åœ¨å°±æŠ›å‡ºå¼‚å¸¸ã€‚</p> <div class="language- extra-class"><pre class="language-text"><code>public abstract class AbstractRoutingDataSource extends AbstractDataSource implements InitializingBean {    //å¤šæ•°æ®æºmapé›†åˆ    private Map&lt;Object, Object&gt; targetDataSources;    //é»˜è®¤æ•°æ®æº    private Object defaultTargetDataSource;    //å…¶å®å°±æ˜¯targetDataSourcesï¼Œåé¢çš„afterPropertiesSetï¼ˆï¼‰æ–¹æ³•ä¼šå°†targetDataSourcesèµ‹å€¼ç»™resolvedDataSources    private Map&lt;Object, DataSource&gt; resolvedDataSources;    private DataSource resolvedDefaultDataSource;    public void setTargetDataSources(Map&lt;Object, Object&gt; targetDataSources) {        this.targetDataSources = targetDataSources;    }    protected DataSource determineTargetDataSource() {        Assert.notNull(this.resolvedDataSources, &quot;DataSource router not initialized&quot;);        Object lookupKey = this.determineCurrentLookupKey();        DataSource dataSource = (DataSource)this.resolvedDataSources.get(lookupKey);        if (dataSource == null &amp;&amp; (this.lenientFallback || lookupKey == null)) {            dataSource = this.resolvedDefaultDataSource;        }        if (dataSource == null) {            throw new IllegalStateException(&quot;Cannot determine target DataSource for lookup key [&quot; + lookupKey + &quot;]&quot;);        } else {            return dataSource;        }    }    protected abstract Object determineCurrentLookupKey();}
</code></pre></div><p><strong>å…·ä½“å®ç°ï¼š</strong></p> <p>**1ã€å®šä¹‰ä¸€ä¸ªåŠ¨æ€æ•°æ®æºï¼š**ç»§æ‰¿AbstractRoutingDataSource æŠ½è±¡ç±»ï¼Œå¹¶é‡å†™determineCurrentLookupKeyï¼ˆï¼‰æ–¹æ³•</p> <div class="language- extra-class"><pre class="language-text"><code>public class DynamicDataSource extends AbstractRoutingDataSource {    @Override    protected Object determineCurrentLookupKey() {        DataSourceType.DataBaseType dataBaseType = DataSourceType.getDataBaseType();        return dataBaseType;    }}
</code></pre></div><p><strong>2ã€åˆ›å»ºä¸€ä¸ªåˆ‡æ¢æ•°æ®æºç±»å‹çš„ç±»ï¼š</strong> ThreadLocalè¿™ä¸ªçŸ¥è¯†ç‚¹å¯ä»¥å‚è€ƒæˆ‘çš„åšå®¢ï¼šhttps://blog.csdn.net/tuesdayma/article/details/74841657 å°±æ˜¯ä¸ºäº†çº¿ç¨‹çš„å®‰å…¨æ€§ï¼Œæ¯ä¸ªçº¿ç¨‹ä¹‹é—´ä¸ä¼šç›¸äº’å½±å“ã€‚</p> <div class="language- extra-class"><pre class="language-text"><code>public class DataSourceType {    public enum DataBaseType {        TEST01, TEST02    }    // ä½¿ç”¨ThreadLocalä¿è¯çº¿ç¨‹å®‰å…¨    private static final ThreadLocal&lt;DataBaseType&gt; TYPE = new ThreadLocal&lt;DataBaseType&gt;();    // å¾€å½“å‰çº¿ç¨‹é‡Œè®¾ç½®æ•°æ®æºç±»å‹    public static void setDataBaseType(DataBaseType dataBaseType) {        if (dataBaseType == null) {            throw new NullPointerException();        }        System.err.println(&quot;[å°†å½“å‰æ•°æ®æºæ”¹ä¸º]ï¼š&quot; + dataBaseType);        TYPE.set(dataBaseType);    }    // è·å–æ•°æ®æºç±»å‹    public static DataBaseType getDataBaseType() {        DataBaseType dataBaseType = TYPE.get() == null ? DataBaseType.TEST01 : TYPE.get();        System.err.println(&quot;[è·å–å½“å‰æ•°æ®æºçš„ç±»å‹ä¸º]ï¼š&quot; + dataBaseType);        return dataBaseType;    }    // æ¸…ç©ºæ•°æ®ç±»å‹    public static void clearDataBaseType() {        TYPE.remove();    }}
</code></pre></div><p>**3ã€å®šä¹‰å¤šä¸ªæ•°æ®æºï¼š**æ€ä¹ˆå®šä¹‰å°±ä¸å¤šè¯´äº†ï¼Œå’Œæ–¹æ³•ä¸€æ˜¯ä¸€æ ·çš„ï¼Œä¸»è¦æ˜¯å°†å®šä¹‰å¥½çš„å¤šä¸ªæ•°æ®æºæ”¾åœ¨åŠ¨æ€æ•°æ®æºä¸­ã€‚</p> <div class="language- extra-class"><pre class="language-text"><code>@Configuration@MapperScan(basePackages = &quot;com.mzd.multipledatasources.mapper&quot;, sqlSessionFactoryRef = &quot;SqlSessionFactory&quot;)public class DataSourceConfig {    @Primary    @Bean(name = &quot;test1DataSource&quot;)    @ConfigurationProperties(prefix = &quot;spring.datasource.test1&quot;)    public DataSource getDateSource1() {        return DataSourceBuilder.create().build();    }    @Bean(name = &quot;test2DataSource&quot;)    @ConfigurationProperties(prefix = &quot;spring.datasource.test2&quot;)    public DataSource getDateSource2() {        return DataSourceBuilder.create().build();    }    @Bean(name = &quot;dynamicDataSource&quot;)    public DynamicDataSource DataSource(@Qualifier(&quot;test1DataSource&quot;) DataSource test1DataSource,            @Qualifier(&quot;test2DataSource&quot;) DataSource test2DataSource) {        Map&lt;Object, Object&gt; targetDataSource = new HashMap&lt;&gt;();        targetDataSource.put(DataSourceType.DataBaseType.TEST01, test1DataSource);        targetDataSource.put(DataSourceType.DataBaseType.TEST02, test2DataSource);        DynamicDataSource dataSource = new DynamicDataSource();        dataSource.setTargetDataSources(targetDataSource);        dataSource.setDefaultTargetDataSource(test1DataSource);        return dataSource;    }    @Bean(name = &quot;SqlSessionFactory&quot;)    public SqlSessionFactory test1SqlSessionFactory(@Qualifier(&quot;dynamicDataSource&quot;) DataSource dynamicDataSource)            throws Exception {        SqlSessionFactoryBean bean = new SqlSessionFactoryBean();        bean.setDataSource(dynamicDataSource);        bean.setMapperLocations(                new PathMatchingResourcePatternResolver().getResources(&quot;classpath*:mapping/*.xml&quot;));        return bean.getObject();    }}
</code></pre></div><p>**4ã€å®šä¹‰AOPï¼š**å°±æ˜¯ä¸åŒä¸šåŠ¡åˆ‡æ¢ä¸åŒæ•°æ®åº“çš„å…¥å£ã€‚å¦‚æœè§‰å¾—executionå¤ªé•¿ä¸æ„¿æ„å†™ï¼Œå°±å¯ä»¥å®šä¹‰ä¸€ä¸ªæ³¨è§£æ¥å®ç°ã€‚å¯å‚è€ƒäºæˆ‘çš„åšå®¢ï¼šhttps://blog.csdn.net/tuesdayma/article/details/79704238</p> <div class="language- extra-class"><pre class="language-text"><code>@Aspect@Componentpublic class DataSourceAop {    @Before(&quot;execution(* com.mzd.multipledatasources.service..*.test01*(..))&quot;)    public void setDataSource2test01() {        System.err.println(&quot;test01ä¸šåŠ¡&quot;);        DataSourceType.setDataBaseType(DataBaseType.TEST01);    }    @Before(&quot;execution(* com.mzd.multipledatasources.service..*.test02*(..))&quot;)    public void setDataSource2test02() {        System.err.println(&quot;test02ä¸šåŠ¡&quot;);        DataSourceType.setDataBaseType(DataBaseType.TEST02);    }}
</code></pre></div><p><strong>æ•´ä½“ç›®å½•å¦‚å›¾ï¼š</strong></p> <p><a href="https://img-blog.csdn.net/20180717181055626?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3R1ZXNkYXltYQ==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" target="_blank" rel="noopener noreferrer">https://img-blog.csdn.net/20180717181055626?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3R1ZXNkYXltYQ==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="ä¸‰ã€ä½¿ç”¨æ³¨è§£æ•´åˆ"><a href="#ä¸‰ã€ä½¿ç”¨æ³¨è§£æ•´åˆ" class="header-anchor">#</a> ä¸‰ã€ä½¿ç”¨æ³¨è§£æ•´åˆ</h2> <p>springboot+druid+mybatisplus</p> <h3 id="ä¸»è¦ä¾èµ–"><a href="#ä¸»è¦ä¾èµ–" class="header-anchor">#</a> ä¸»è¦ä¾èµ–</h3> <div class="language- extra-class"><pre class="language-text"><code>spring-boot-starter-webmybatis-plus-boot-starterdynamic-datasource-spring-boot-starter # é…ç½®åŠ¨æ€æ•°æ®æºdruid-spring-boot-starter # é˜¿é‡Œçš„æ•°æ®åº“è¿æ¥æ± mysql-connector-javalombok
</code></pre></div><p>pom.xmlæ–‡ä»¶</p> <div class="language- extra-class"><pre class="language-text"><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;        xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;   &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;   &lt;parent&gt;       &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;       &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;       &lt;version&gt;2.1.9.RELEASE&lt;/version&gt;       &lt;relativePath/&gt; &lt;!-- lookup parent from repository --&gt;   &lt;/parent&gt;   &lt;groupId&gt;com.example&lt;/groupId&gt;   &lt;artifactId&gt;mutipledatasource2&lt;/artifactId&gt;   &lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt;   &lt;name&gt;mutipledatasource2&lt;/name&gt;   &lt;description&gt;Demo project for Spring Boot&lt;/description&gt;   &lt;properties&gt;       &lt;java.version&gt;1.8&lt;/java.version&gt;   &lt;/properties&gt;   &lt;dependencies&gt;       &lt;dependency&gt;           &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;           &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;       &lt;/dependency&gt;       &lt;dependency&gt;           &lt;groupId&gt;com.baomidou&lt;/groupId&gt;           &lt;artifactId&gt;mybatis-plus-boot-starter&lt;/artifactId&gt;           &lt;version&gt;3.2.0&lt;/version&gt;       &lt;/dependency&gt;       &lt;dependency&gt;           &lt;groupId&gt;com.baomidou&lt;/groupId&gt;           &lt;artifactId&gt;dynamic-datasource-spring-boot-starter&lt;/artifactId&gt;           &lt;version&gt;2.5.6&lt;/version&gt;       &lt;/dependency&gt;       &lt;dependency&gt;           &lt;groupId&gt;mysql&lt;/groupId&gt;           &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt;           &lt;scope&gt;runtime&lt;/scope&gt;       &lt;/dependency&gt;       &lt;dependency&gt;           &lt;groupId&gt;com.alibaba&lt;/groupId&gt;           &lt;artifactId&gt;druid-spring-boot-starter&lt;/artifactId&gt;           &lt;version&gt;1.1.20&lt;/version&gt;       &lt;/dependency&gt;       &lt;dependency&gt;           &lt;groupId&gt;org.projectlombok&lt;/groupId&gt;           &lt;artifactId&gt;lombok&lt;/artifactId&gt;           &lt;optional&gt;true&lt;/optional&gt;       &lt;/dependency&gt;       &lt;dependency&gt;           &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;           &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt;           &lt;scope&gt;test&lt;/scope&gt;       &lt;/dependency&gt;   &lt;/dependencies&gt;   &lt;build&gt;       &lt;plugins&gt;           &lt;plugin&gt;               &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;               &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;           &lt;/plugin&gt;       &lt;/plugins&gt;   &lt;/build&gt;   &lt;profiles&gt;       &lt;profile&gt;           &lt;id&gt;local1&lt;/id&gt;           &lt;properties&gt;               &lt;profileActive&gt;local1&lt;/profileActive&gt;           &lt;/properties&gt;           &lt;activation&gt;               &lt;activeByDefault&gt;true&lt;/activeByDefault&gt;           &lt;/activation&gt;       &lt;/profile&gt;       &lt;profile&gt;           &lt;id&gt;local2&lt;/id&gt;           &lt;properties&gt;               &lt;profileActive&gt;local2&lt;/profileActive&gt;           &lt;/properties&gt;       &lt;/profile&gt;   &lt;/profiles&gt;&lt;/project&gt;
</code></pre></div><h3 id="application-yml-é…ç½®æ–‡ä»¶"><a href="#application-yml-é…ç½®æ–‡ä»¶" class="header-anchor">#</a> application.yml é…ç½®æ–‡ä»¶</h3> <div class="language- extra-class"><pre class="language-text"><code>server:  port: 8080spring:  datasource:    dynamic:      primary: db1 # é…ç½®é»˜è®¤æ•°æ®åº“      datasource:        db1: # æ•°æ®æº1é…ç½®          url: jdbc:mysql://localhost:3306/db1?characterEncoding=utf8&amp;useUnicode=true&amp;useSSL=false&amp;serverTimezone=GMT%2B8          username: root          password: root          driver-class-name: com.mysql.cj.jdbc.Driver        db2: # æ•°æ®æº2é…ç½®          url: jdbc:mysql://localhost:3306/db2?characterEncoding=utf8&amp;useUnicode=true&amp;useSSL=false&amp;serverTimezone=GMT%2B8          username: root          password: root          driver-class-name: com.mysql.cj.jdbc.Driver      durid:        initial-size: 1        max-active: 20        min-idle: 1        max-wait: 60000  autoconfigure:    exclude:  com.alibaba.druid.spring.boot.autoconfigure.DruidDataSourceAutoConfigure # å»é™¤druidé…ç½®
</code></pre></div><p><code>DruidDataSourceAutoConfigure</code>ä¼šæ³¨å…¥ä¸€ä¸ª<code>DataSourceWrapper</code>ï¼Œå…¶ä¼šåœ¨åŸç”Ÿçš„<code>spring.datasource</code>ä¸‹æ‰¾ url, username, password ç­‰ã€‚åŠ¨æ€æ•°æ®æº URL ç­‰é…ç½®æ˜¯åœ¨ dynamic ä¸‹ï¼Œå› æ­¤éœ€è¦æ’é™¤ï¼Œå¦åˆ™ä¼šæŠ¥é”™ã€‚æ’é™¤æ–¹å¼æœ‰ä¸¤ç§ï¼Œä¸€ç§æ˜¯ä¸Šè¿°é…ç½®æ–‡ä»¶æ’é™¤ï¼Œè¿˜æœ‰ä¸€ç§å¯ä»¥åœ¨é¡¹ç›®å¯åŠ¨ç±»æ’é™¤ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>@SpringBootApplication(exclude = DruidDataSourceAutoConfigure.class)public class Application {  public static void main(String[] args) {    SpringApplication.run(Application.class, args);  }}
</code></pre></div><h3 id="ç»™ä½¿ç”¨éé»˜è®¤æ•°æ®æºæ·»åŠ æ³¨è§£-ds"><a href="#ç»™ä½¿ç”¨éé»˜è®¤æ•°æ®æºæ·»åŠ æ³¨è§£-ds" class="header-anchor">#</a> ç»™ä½¿ç”¨éé»˜è®¤æ•°æ®æºæ·»åŠ æ³¨è§£@DS</h3> <p><code>@DS</code> å¯ä»¥æ³¨è§£åœ¨æ–¹æ³•ä¸Šå’Œç±»ä¸Šï¼ŒåŒæ—¶å­˜åœ¨æ–¹æ³•æ³¨è§£ä¼˜å…ˆäºç±»ä¸Šæ³¨è§£ã€‚ æ³¨è§£åœ¨ service å®ç°æˆ– mapper æ¥å£æ–¹æ³•ä¸Šï¼Œä¸è¦åŒæ—¶åœ¨ service å’Œ mapper æ³¨è§£ã€‚</p> <div class="language- extra-class"><pre class="language-text"><code>@DS(&quot;db2&quot;) public interface UserMapper extends BaseMapper&lt;User&gt; {}@Service@DS(&quot;db2&quot;)public class ModelServiceImpl extends ServiceImpl&lt;ModelMapper, Model&gt; implements IModelService {}  @Select(&quot;SELECT * FROM user&quot;)  @DS(&quot;db2&quot;)  List&lt;User&gt; selectAll();
</code></pre></div><h1 id="springbooté…ç½®å¤šæ•°æ®æºmybatisé…ç½®å¤±æ•ˆé—®é¢˜"><a href="#springbooté…ç½®å¤šæ•°æ®æºmybatisé…ç½®å¤±æ•ˆé—®é¢˜" class="header-anchor">#</a> springbooté…ç½®å¤šæ•°æ®æºmybatisé…ç½®å¤±æ•ˆé—®é¢˜</h1> <p>å‚è€ƒé“¾æ¥: https://blog.csdn.net/weixin_30256901/article/details/99267676 å‚è€ƒé“¾æ¥: https://blog.csdn.net/qq_38380025/article/details/84636408</p> <p>mybatisé…ç½®</p> <div class="language- extra-class"><pre class="language-text"><code>#å¼€å¯é©¼å³°æ˜ å°„mybatis.configuration.map-underscore-to-camel-case=true#å¼€å¯æ‰“å°sqlmybatis.configuration.log-impl=org.apache.ibatis.logging.stdout.StdOutImpl
</code></pre></div><p>å¤±æ•ˆå¤„ç†</p> <div class="language- extra-class"><pre class="language-text"><code>    @Bean    @ConfigurationProperties(prefix = &quot;mybatis.configuration&quot;)    public org.apache.ibatis.session.Configuration globalConfiguration() {        return new org.apache.ibatis.session.Configuration();    }    @Bean    public SqlSessionFactory sqlSessionFactory(org.apache.ibatis.session.Configuration config) throws Exception {        SqlSessionFactoryBean sqlSessionFactoryBean = new SqlSessionFactoryBean();        sqlSessionFactoryBean.setDataSource(myRoutingDataSource);        sqlSessionFactoryBean.setTypeAliasesPackage(&quot;com.bling.dab.domain&quot;);        sqlSessionFactoryBean.setConfiguration(config);        sqlSessionFactoryBean.setMapperLocations(new PathMatchingResourcePatternResolver().getResources(&quot;classpath:mapper/*.xml&quot;));        return sqlSessionFactoryBean.getObject();
</code></pre></div><p>é—®é¢˜è§£å†³ï¼Œå¤±æ•ˆåŸå› æ˜¯é…ç½®å¤šæ•°æ®æºï¼Œè‡ªå®šä¹‰çš„sqlsessionFactoryä¸ä¼šåŠ è½½mybatisé…ç½®ï¼Œè€Œå•æ•°æ®æºçš„sqlsessionFactoryä¸æ˜¯è‡ªå®šä¹‰çš„é»˜è®¤å»åŠ è½½äº†mybatisé…ç½®</p></div></div> <!----> <div class="page-edit"><!----> <!----> <!----></div> <div class="page-nav-wapper"><div class="page-nav-centre-wrap"><a href="/pages/fd10b9/" class="page-nav-centre page-nav-centre-prev"><div class="tooltip">åˆ†å¸ƒå¼äº‹åŠ¡</div></a> <a href="/pages/682583/" class="page-nav-centre page-nav-centre-next"><div class="tooltip">HashMap</div></a></div> <div class="page-nav"><p class="inner"><span class="prev">
        â†
        <a href="/pages/fd10b9/" class="prev">åˆ†å¸ƒå¼äº‹åŠ¡</a></span> <span class="next"><a href="/pages/682583/">HashMap</a>â†’
      </span></p></div></div></div> <!----></main></div> <div class="footer"><!----> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="æœ¬ç«™ä¸»é¢˜">Vdoing</a> 
    | Copyright Â© 2022-2022
    <span>å¼ å¤§å–µ</span></div> <div class="buttons"><div title="è¿”å›é¡¶éƒ¨" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="å»è¯„è®º" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="ä¸»é¢˜æ¨¡å¼" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          è·Ÿéšç³»ç»Ÿ
        </li><li class="iconfont icon-rijianmoshi">
          æµ…è‰²æ¨¡å¼
        </li><li class="iconfont icon-yejianmoshi">
          æ·±è‰²æ¨¡å¼
        </li><li class="iconfont icon-yuedu">
          é˜…è¯»æ¨¡å¼
        </li></ul></div></div> <div class="body-bg" style="background:url() center center / cover no-repeat;opacity:0.5;"></div> <!----> <!----></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.9ac200f5.js" defer></script><script src="/assets/js/2.f08c2e94.js" defer></script><script src="/assets/js/41.0955ce39.js" defer></script>
  </body>
</html>
