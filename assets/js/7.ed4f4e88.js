(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{320:function(t,e,a){"use strict";a.r(e);var s=a(3),r=Object(s.a)({},(function(){var t=this,e=t._self._c;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h1",{attrs:{id:"dddæŠ½å¥–ç³»ç»Ÿå­¦ä¹ æ‰“å¡ğŸš€-day-2"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#dddæŠ½å¥–ç³»ç»Ÿå­¦ä¹ æ‰“å¡ğŸš€-day-2"}},[t._v("#")]),t._v(" DDDæŠ½å¥–ç³»ç»Ÿå­¦ä¹ æ‰“å¡ğŸš€ day 2")]),t._v(" "),e("p",[t._v("Created: January 30, 2022 8:54 AM")]),t._v(" "),e("h1",{attrs:{id:"ç®€å•å·¥å‚æ¨¡å¼"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#ç®€å•å·¥å‚æ¨¡å¼"}},[t._v("#")]),t._v(" ç®€å•å·¥å‚æ¨¡å¼")]),t._v(" "),e("p",[t._v("ç¬¬7èŠ‚ä¸­ï¼Œä½¿ç”¨ç®€å•å·¥å‚æ¨¡å¼è¿›è¡Œä¸åŒçš„å¥–å“çš„æ–¹æ³•")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("å·¥ç¨‹ç»“æ„\nlottery-domain\nâ””â”€â”€ src\n    â””â”€â”€ main\n        â””â”€â”€ java\n            â””â”€â”€ cn.itedus.lottery.domain.award\n                â”œâ”€â”€ model\n                â”œâ”€â”€ repository\n                â”‚   â”œâ”€â”€ impl\n                â”‚   â”‚   â””â”€â”€ AwardRepository\n                â”‚   â””â”€â”€ IAwardRepository\n                â””â”€â”€ service\n                    â”œâ”€â”€ factory\n                    â”‚   â”œâ”€â”€ DistributionGoodsFactory.java\n                    â”‚   â””â”€â”€ GoodsConfig.java\n                    â””â”€â”€ goods\n                        â”œâ”€â”€ impl\n                        â”‚   â”œâ”€â”€ CouponGoods.java\n                        â”‚   â”œâ”€â”€ DescGoods.java\n                        â”‚   â”œâ”€â”€ PhysicalGoods.java\n                        â”‚   â””â”€â”€ RedeemCodeGoods.java\n                        â”œâ”€â”€ DistributionBase.java\n                        â””â”€â”€ IDistributionGoodsc.java\n")])])]),e("h2",{attrs:{id:"å®šä¹‰ä¸€ä¸ªå‘å¥–æ¥å£"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#å®šä¹‰ä¸€ä¸ªå‘å¥–æ¥å£"}},[t._v("#")]),t._v(" å®šä¹‰ä¸€ä¸ªå‘å¥–æ¥å£")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("public interface IDistributionGoods {    /**     * å¥–å“é…é€æ¥å£ï¼Œå¥–å“ç±»å‹ï¼ˆ1:æ–‡å­—æè¿°ã€2:å…‘æ¢ç ã€3:ä¼˜æƒ åˆ¸ã€4:å®ç‰©å¥–å“ï¼‰     *     * @param req   ç‰©å“ä¿¡æ¯     * @return      é…é€ç»“æœ     */    DistributionRes doDistribution(GoodsReq req);}\n")])])]),e("h2",{attrs:{id:"ç„¶ååšä¸åŒçš„å®ç°"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#ç„¶ååšä¸åŒçš„å®ç°"}},[t._v("#")]),t._v(" ç„¶ååšä¸åŒçš„å®ç°")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v('@Componentpublic class CouponGoods extends DistributionBase implements IDistributionGoods {    @Override    public DistributionRes doDistribution(GoodsReq req) {        // æ¨¡æ‹Ÿè°ƒç”¨ä¼˜æƒ åˆ¸å‘æ”¾æ¥å£        logger.info("æ¨¡æ‹Ÿè°ƒç”¨ä¼˜æƒ åˆ¸å‘æ”¾æ¥å£ uIdï¼š{} awardContentï¼š{}", req.getuId(), req.getAwardContent());        // æ›´æ–°ç”¨æˆ·é¢†å¥–ç»“æœ        super.updateUserAwardState(req.getuId(), req.getOrderId(), req.getAwardId(), Constants.AwardState.SUCCESS.getCode(), Constants.AwardState.SUCCESS.getInfo());        return new DistributionRes(req.getuId(), Constants.AwardState.SUCCESS.getCode(), Constants.AwardState.SUCCESS.getInfo());    }}\n')])])]),e("h2",{attrs:{id:"å®šä¹‰å‘å¥–å®ç°çš„æšä¸¾"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#å®šä¹‰å‘å¥–å®ç°çš„æšä¸¾"}},[t._v("#")]),t._v(" å®šä¹‰å‘å¥–å®ç°çš„æšä¸¾")]),t._v(" "),e("p",[t._v("è¿™æ ·å°±ä¸ç”¨ä½¿ç”¨é­”æ³•å€¼çš„")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v('public enum AwardType {    /**     * æ–‡å­—æè¿°     */    DESC(1, "æ–‡å­—æè¿°"),    /**     * å…‘æ¢ç      */    RedeemCodeGoods(2, "å…‘æ¢ç "),    /**     * ä¼˜æƒ åˆ¸     */    CouponGoods(3, "ä¼˜æƒ åˆ¸"),    /**     * å®ç‰©å¥–å“     */    PhysicalGoods(4, "å®ç‰©å¥–å“");    private Integer code;    private String info;    AwardType(Integer code, String info) {        this.code = code;        this.info = info;    }    public Integer getCode() {        return code;    }    public void setCode(Integer code) {        this.code = code;    }    public String getInfo() {        return info;    }    public void setInfo(String info) {        this.info = info;    }}\n')])])]),e("h2",{attrs:{id:"å®šä¹‰ä¸€ä¸ªç®€å•å·¥å‚é…ç½®"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#å®šä¹‰ä¸€ä¸ªç®€å•å·¥å‚é…ç½®"}},[t._v("#")]),t._v(" å®šä¹‰ä¸€ä¸ªç®€å•å·¥å‚é…ç½®")]),t._v(" "),e("p",[t._v("å°†å…·ä½“çš„å®ç°æ³¨å…¥è¿›å»ï¼Œå£°æ˜ä¸€ä¸ªmapï¼Œä»¥å®ç°çš„æšä¸¾codeåškeyï¼Œå®ç°ç±»åšvalueå­˜å…¥")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("public class GoodsConfig {    /** å¥–å“å‘æ”¾ç­–ç•¥ç»„ */    protected static Map<Integer, IDistributionGoods> goodsMap = new ConcurrentHashMap<>();    @Resource    private DescGoods descGoods;    @Resource    private RedeemCodeGoods redeemCodeGoods;    @Resource    private CouponGoods couponGoods;    @Resource    private PhysicalGoods physicalGoods;    @PostConstruct    public void init() {        goodsMap.put(Constants.AwardType.DESC.getCode(), descGoods);        goodsMap.put(Constants.AwardType.RedeemCodeGoods.getCode(), redeemCodeGoods);        goodsMap.put(Constants.AwardType.CouponGoods.getCode(), couponGoods);        goodsMap.put(Constants.AwardType.PhysicalGoods.getCode(), physicalGoods);    }}\n")])])]),e("h2",{attrs:{id:"å®šä¹‰ä¸€ä¸ªç®€å•å·¥å‚ç»§æ‰¿é…ç½®"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#å®šä¹‰ä¸€ä¸ªç®€å•å·¥å‚ç»§æ‰¿é…ç½®"}},[t._v("#")]),t._v(" å®šä¹‰ä¸€ä¸ªç®€å•å·¥å‚ç»§æ‰¿é…ç½®")]),t._v(" "),e("p",[t._v("å£°æ˜ä¸€ä¸ªgetå®ç°æ–¹æ³•ï¼Œä¼ å…¥å€¼å°±æ˜¯å¯¹åº”æšä¸¾çš„code")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("public class DistributionGoodsFactory extends GoodsConfig {    public IDistributionGoods getDistributionGoodsService(Integer awardType){        return goodsMap.get(awardType);    }}\n")])])]),e("p",[t._v("ä½¿ç”¨æ—¶ï¼Œé€šè¿‡å·¥å‚çš„getæ–¹æ³•ï¼Œä¼ å…¥ä¸åŒå®ç°å¯¹åº”çš„codeå³å¯å–å‡ºå¯¹åº”çš„å®ç°å®ä¾‹")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("IDistributionGoods distributionGoodsService = distributionGoodsFactory.getDistributionGoodsService(drawAwardInfo.getAwardType());DistributionRes distributionRes = distributionGoodsService.doDistribution(goodsReq);\n")])])]),e("h1",{attrs:{id:"çŠ¶æ€æ¨¡å¼"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#çŠ¶æ€æ¨¡å¼"}},[t._v("#")]),t._v(" çŠ¶æ€æ¨¡å¼")]),t._v(" "),e("p",[t._v("ç¬¬8èŠ‚ä¸­å¯¹äºæ´»åŠ¨çš„çŠ¶æ€å˜æ›´ä½¿ç”¨çš„çŠ¶æ€æ¨¡å¼")]),t._v(" "),e("p",[t._v("çœ‹ä¸‹é¢è¿™ä¸ªå›¾å°±çŸ¥é“æµç¨‹æ¯”è¾ƒè´Ÿè´£ï¼Œé€šè¿‡ifelseå°±ä¼šå¾ˆä¹±")]),t._v(" "),e("p",[e("img",{attrs:{src:"/img/other/image-20220106223828639.png",alt:"/img/other/image-20220106223828639.png"}})]),t._v(" "),e("p",[t._v("image-20220106223828639")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("å·¥ç¨‹ç»“æ„\nlottery-domain\nâ””â”€â”€ src\n    â””â”€â”€ main\n        â””â”€â”€ java\n            â””â”€â”€ cn.itedus.lottery.domain.activity\n                â”œâ”€â”€ model\n                â”œâ”€â”€ repository\n                â”‚   â””â”€â”€ IActivityRepository\n                â””â”€â”€ service\n                    â”œâ”€â”€ deploy\n                    â”œâ”€â”€ partake [å¾…å¼€å‘]\n                    â””â”€â”€ stateflow\n                        â”œâ”€â”€ event\n                        â”‚   â”œâ”€â”€ ArraignmentState.java\n                        â”‚   â”œâ”€â”€ CloseState.java\n                        â”‚   â”œâ”€â”€ DoingState.java\n                        â”‚   â”œâ”€â”€ EditingState.java\n                        â”‚   â”œâ”€â”€ OpenState.java\n                        â”‚   â”œâ”€â”€ PassState.java\n                        â”‚   â””â”€â”€ RefuseState.java\n                        â”œâ”€â”€ impl\n                        â”‚   â””â”€â”€ StateHandlerImpl.java\n                        â”œâ”€â”€ AbstractState.java\n                        â”œâ”€â”€ IStateHandler.java\n                        â””â”€â”€ StateConfig.java\n")])])]),e("h2",{attrs:{id:"å®šä¹‰çŠ¶æ€æŠ½è±¡ç±»æˆ–è€…æ¥å£"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#å®šä¹‰çŠ¶æ€æŠ½è±¡ç±»æˆ–è€…æ¥å£"}},[t._v("#")]),t._v(" å®šä¹‰çŠ¶æ€æŠ½è±¡ç±»æˆ–è€…æ¥å£")]),t._v(" "),e("p",[t._v("é‡Œé¢æ˜¯æ‰€æœ‰çš„åŠ¨ä½œï¼Œæ¯”å¦‚æäº¤ï¼Œå®¡æ‰¹ï¼Œæ’¤å›ç­‰ç­‰")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("public abstract class AbstractState {    @Resource    protected IActivityRepository activityRepository;    /**     * æ´»åŠ¨æå®¡     *     * @param activityId   æ´»åŠ¨ID     * @param currentState å½“å‰çŠ¶æ€     * @return æ‰§è¡Œç»“æœ     */    public abstract Result arraignment(Long activityId, Enum<Constants.ActivityState> currentState);    /**     * å®¡æ ¸é€šè¿‡     *     * @param activityId   æ´»åŠ¨ID     * @param currentState å½“å‰çŠ¶æ€     * @return æ‰§è¡Œç»“æœ     */    public abstract Result checkPass(Long activityId, Enum<Constants.ActivityState> currentState);    /**     * å®¡æ ¸æ‹’ç»     *     * @param activityId   æ´»åŠ¨ID     * @param currentState å½“å‰çŠ¶æ€     * @return æ‰§è¡Œç»“æœ     */    public abstract Result checkRefuse(Long activityId, Enum<Constants.ActivityState> currentState);    /**     * æ’¤å®¡æ’¤é”€     *     * @param activityId   æ´»åŠ¨ID     * @param currentState å½“å‰çŠ¶æ€     * @return æ‰§è¡Œç»“æœ     */    public abstract Result checkRevoke(Long activityId, Enum<Constants.ActivityState> currentState);    /**     * æ´»åŠ¨å…³é—­     *     * @param activityId   æ´»åŠ¨ID     * @param currentState å½“å‰çŠ¶æ€     * @return æ‰§è¡Œç»“æœ     */    public abstract Result close(Long activityId, Enum<Constants.ActivityState> currentState);    /**     * æ´»åŠ¨å¼€å¯     *     * @param activityId   æ´»åŠ¨ID     * @param currentState å½“å‰çŠ¶æ€     * @return æ‰§è¡Œç»“æœ     */    public abstract Result open(Long activityId, Enum<Constants.ActivityState> currentState);    /**     * æ´»åŠ¨æ‰§è¡Œ     *     * @param activityId   æ´»åŠ¨ID     * @param currentState å½“å‰çŠ¶æ€     * @return æ‰§è¡Œç»“æœ     */    public abstract Result doing(Long activityId, Enum<Constants.ActivityState> currentState);}\n")])])]),e("h2",{attrs:{id:"æ ¹æ®çŠ¶æ€ä½œå‡ºæ‰€æœ‰çš„å®ç°"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#æ ¹æ®çŠ¶æ€ä½œå‡ºæ‰€æœ‰çš„å®ç°"}},[t._v("#")]),t._v(" æ ¹æ®çŠ¶æ€ä½œå‡ºæ‰€æœ‰çš„å®ç°")]),t._v(" "),e("p",[t._v("rvrntä¸­å°±æ˜¯çŠ¶æ€å®ç°ï¼Œå®ç°ä¸­å°†è¯¥çŠ¶æ€ä¸‹æ‰€æœ‰çš„åŠ¨ä½œæ–¹æ³•è¿›è¡Œå®ç°ï¼Œå“ªäº›å¯æ‰§è¡Œæ€ä¹ˆæ‰§è¡Œã€‚æ¯”å¦‚æäº¤å®¡æ ¸çš„çŠ¶æ€ä¸‹çš„æ’¤å›åŠ¨ä½œå¯ä»¥æ­£å¸¸æ‰§è¡Œï¼Œè€Œå‘å¸ƒæ–¹æ³•å°±ä¸èƒ½æ‰§è¡Œéœ€è¦é”™è¯¯æ“ä½œæé†’")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v('@Componentpublic class ArraignmentState extends AbstractState {    @Override    public Result arraignment(Long activityId, Enum<Constants.ActivityState> currentState) {        return Result.buildResult(Constants.ResponseCode.UN_ERROR, "å¾…å®¡æ ¸çŠ¶æ€ä¸å¯é‡å¤æå®¡");    }    @Override    public Result checkPass(Long activityId, Enum<Constants.ActivityState> currentState) {        boolean isSuccess = activityRepository.alterStatus(activityId, currentState, Constants.ActivityState.PASS);        return isSuccess ? Result.buildResult(Constants.ResponseCode.SUCCESS, "æ´»åŠ¨å®¡æ ¸é€šè¿‡å®Œæˆ") : Result.buildErrorResult("æ´»åŠ¨çŠ¶æ€å˜æ›´å¤±è´¥");    }    @Override    public Result checkRefuse(Long activityId, Enum<Constants.ActivityState> currentState) {        boolean isSuccess = activityRepository.alterStatus(activityId, currentState, Constants.ActivityState.REFUSE);        return isSuccess ? Result.buildResult(Constants.ResponseCode.SUCCESS, "æ´»åŠ¨å®¡æ ¸æ‹’ç»å®Œæˆ") : Result.buildErrorResult("æ´»åŠ¨çŠ¶æ€å˜æ›´å¤±è´¥");    }    @Override    public Result checkRevoke(Long activityId, Enum<Constants.ActivityState> currentState) {        boolean isSuccess = activityRepository.alterStatus(activityId, currentState, Constants.ActivityState.EDIT);        return isSuccess ? Result.buildResult(Constants.ResponseCode.SUCCESS, "æ´»åŠ¨å®¡æ ¸æ’¤é”€å›åˆ°ç¼–è¾‘ä¸­") : Result.buildErrorResult("æ´»åŠ¨çŠ¶æ€å˜æ›´å¤±è´¥");    }    @Override    public Result close(Long activityId, Enum<Constants.ActivityState> currentState) {        boolean isSuccess = activityRepository.alterStatus(activityId, currentState, Constants.ActivityState.CLOSE);        return isSuccess ? Result.buildResult(Constants.ResponseCode.SUCCESS, "æ´»åŠ¨å®¡æ ¸å…³é—­å®Œæˆ") : Result.buildErrorResult("æ´»åŠ¨çŠ¶æ€å˜æ›´å¤±è´¥");    }    @Override    public Result open(Long activityId, Enum<Constants.ActivityState> currentState) {        return Result.buildResult(Constants.ResponseCode.UN_ERROR, "éå…³é—­æ´»åŠ¨ä¸å¯å¼€å¯");    }    @Override    public Result doing(Long activityId, Enum<Constants.ActivityState> currentState) {        return Result.buildResult(Constants.ResponseCode.UN_ERROR, "å¾…å®¡æ ¸æ´»åŠ¨ä¸å¯æ‰§è¡Œæ´»åŠ¨ä¸­å˜æ›´");    }}\n')])])]),e("h2",{attrs:{id:"å£°æ˜æšä¸¾å’Œé…ç½®"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#å£°æ˜æšä¸¾å’Œé…ç½®"}},[t._v("#")]),t._v(" å£°æ˜æšä¸¾å’Œé…ç½®")]),t._v(" "),e("p",[t._v("è¿™ä¸ªå’Œæ™®é€šå·¥å‚å·®ä¸å¤š")]),t._v(" "),e("p",[t._v("ä½¿ç”¨æ—¶é€šè¿‡é…ç½®æˆ–è€…åŒ…ä¸€å±‚ä¸Šä¸‹æ–‡ï¼Œé€šè¿‡ä¼ å…¥å½“å‰çš„çŠ¶æ€è·å–å¯¹åº”çš„å®ç°ç±»ï¼Œç„¶åæ‰§è¡ŒåŠ¨ä½œ")]),t._v(" "),e("h1",{attrs:{id:"åˆ†åº“åˆ†è¡¨çš„ç®€å•å®ç°"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#åˆ†åº“åˆ†è¡¨çš„ç®€å•å®ç°"}},[t._v("#")]),t._v(" åˆ†åº“åˆ†è¡¨çš„ç®€å•å®ç°")]),t._v(" "),e("p",[t._v("å¯¹åº”ç¬¬åèŠ‚")]),t._v(" "),e("p",[t._v("ä»£ç æ¯”è¾ƒå¤šå…·ä½“å¯ä»¥çœ‹æºç ï¼Œè¿™é‡Œè´´ä¸€ä¸ªåˆ†åº“åŠ¨ä½œ åˆ†è¡¨åŠ¨ä½œ æ€ä¹ˆå®ç°çš„å›¾")]),t._v(" "),e("p",[e("img",{attrs:{src:"/img/other/image-20220106225243822.png",alt:"/img/other/image-20220106225243822.png"}})]),t._v(" "),e("p",[t._v("image-20220106225243822")])])}),[],!1,null,null,null);e.default=r.exports}}]);